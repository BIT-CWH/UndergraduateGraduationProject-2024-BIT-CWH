# 题目
微内核操作系统ReL4中基于用户态中断的异步系统调用设计  
Design of Asynchronous System Call Based on User Mode Interrupt in Microkernel Operating System ReL4
# 选题依据
研究背景+研究意义+国内外研究现状以及发展趋势  
微内核是将操作系统内核的功能划分为最小的核心组件，只包含最基本的功能，如进程调度、内存管理和通信机制的一种操作系统内核实现形式。因为内核仅包含基本功能，其他服务在用户空间运行，采用客户端/服务器模式，所以系统更容易进行扩展和升级，并且内核允许用户选择和替换系统服务，使得系统更加灵活和定制化。  
微内核的性能瓶颈主要来源于内核中的组件通常通过进程间通信进行交互，例如消息传递。这种通信机制可能引入额外的开销，如当执行不同任务时，需要进行频繁的上下文切换。这包括从用户态到内核态的切换，以及在不同用户态任务之间的切换，上下文切换本身会引入一定的开销，特别是在多任务和多核系统中。  
传统操作系统的进程通信可以大致分为两类：一类为进程间通过操作系统内核提供的接口（如管道、信号）进行通信，另一类是在基于用户态进程中通过共享内存进行通信。
通过操作系统内核的接口进行通信会带来上下文切换开销，系统吞吐量低，但这种方法CPU占用低。而通过共享内存进行通信无切换开销，系统吞吐量高，但需要循环检查消息是否到来，CPU存在忙等现象，占用高。
为了提升操作系统IPC性能，可以使用硬件机制，由硬件切换进程上下文，无需陷入，但需要增加硬件以及修改操作系统。为此引入用户态中断的机制，使得用户程序在处理中断时不需要陷入内核。其大致工作流程如下：
接收方：处于用户态，向操作系统注册handler，注册vec封装为fd，分享fd给发送方  
发送方：用户态或内核态，使用fd注册sender  
操作系统：将中断内容写入硬件    
关键结构：在中断处理表中注册，表中表项存在指向用户进程中断接受的指针 
中断流程：发送方由senduipi指令写入硬件，硬件直接发送中断进入handler（或等待OS调度目标进程）  
IPC与系统调用的关系，系统调用可以视作单向的IPC  
TODO：国内外研究现状+发展趋势
# 研究目标
目标+主要内容+关键问题  
ReL4是⽤Rust重写的支持seL4在RISCV上的系统调用的微内核，用户态中断允许应用不经过内核直接向其他应用发送信号。当前的ReL4微内核以同步IPC进⾏系统调用。  
利用RISCV平台已有的⽤户态中断机制，对ReL4微内核中的同步系统调用进⾏异步化改造，减少内核陷⼊和上下⽂切换次数，从⽽降低IPC开销，提升系统性能。

# 研究方案
拟采用的研究方法、技术路线、实验方案和可行性分析  
理解微内核的相关概念，了解微内核的发展趋势和性能瓶颈。
理解seL4的IPC机制，理解其中的优势和弊端。
学习理解⽤户态中断的相关知识。
学习使⽤Rust异步编程的相关技能。
RAII
编写测试用例
# 研究计划及进度安排
2023年12月：完成选题工作。  
2024年1月-2024年2月：完成Rust语言学习、完成rCore实验并完成开题工作  
2024年3月-2024年4月：配置rel4环境并开始研究工作  
2024年4月-2024年5月：完成模型测试和中期答辩  
2024年5月-2024年6月：完成论文撰写和毕业设计答辩
# 创新点及预期研究成果
# 参考文献
[1] Klein G, Elphinstone K, Heiser G, et al. seL4: Formal verification of an OS kernel[C]//Proceedings of the ACM SIGOPS 22nd symposium on Operating systems
principles. 2009: 207-220.  
[2] Heiser G, Elphinstone K. L4 microkernels: The lessons from 20 years of research and deployment[J]. ACM Transactions on Computer Systems (TOCS), 2016, 34(1): 1-29.  
[3] Klimiankou Y. Micro-CLK: returning to the asynchronicity with communication-less microkernel[C]//Proceedings of the 12th ACM SIGOPS Asia-Pacific Workshop on Systems. 2021: 106-114.  
[4] Heiser G. The seL4 Microkernel–An Introduction[J]. The seL4 Foundation, 2020, 1.


